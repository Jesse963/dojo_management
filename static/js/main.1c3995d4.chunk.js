(this.webpackJsonpdojo_management=this.webpackJsonpdojo_management||[]).push([[0],{259:function(t,e,n){"use strict";n.r(e);var s=n(3),a=n.n(s),c=n(10),r=n.n(c),i=n(9),o=n.n(i),l=n(12),d=n(4),u=n(5),h=n(8),p=n(7),b=n(0),j=function(){return Object(b.jsx)("nav",{className:"navbar navbar-dark bg-dark",children:Object(b.jsxs)("a",{className:"navbar-brand",href:"/",children:["Dojo Management",Object(b.jsx)("span",{className:"badge badge-pill badge-secondary"})]})})},m=function(t){Object(h.a)(n,t);var e=Object(p.a)(n);function n(){var t;Object(d.a)(this,n);for(var s=arguments.length,a=new Array(s),c=0;c<s;c++)a[c]=arguments[c];return(t=e.call.apply(e,[this].concat(a))).state={selected:!1},t.handleClick=function(){t.setState((function(t){return{selected:!t.selected}})),t.props.addStudentToAttending(t.props.name,t.state.selected)},t.checkStyle=function(){var e="btn mt-2 ";return e+=t.state.selected?"btn-success":"btn-outline-dark"},t}return Object(u.a)(n,[{key:"render",value:function(){return Object(b.jsx)("li",{children:Object(b.jsx)("button",{onClick:this.handleClick,className:this.checkStyle(),style:{width:"100%"},children:this.props.name})})}}]),n}(s.Component),g=n(92),f=n.n(g),x=(n(105),n(32),function(t){Object(h.a)(n,t);var e=Object(p.a)(n);function n(){var t;Object(d.a)(this,n);for(var s=arguments.length,a=new Array(s),c=0;c<s;c++)a[c]=arguments[c];return(t=e.call.apply(e,[this].concat(a))).state={currentAttendance:[],students:t.props.students},t.studentSearchOnChange=function(e){t.setState({students:t.props.students.filter((function(t){return t.name.toLowerCase().includes(e.target.value)}))})},t.addStudentToAttending=function(e,n){var s=t.state.currentAttendance;s.includes(e)?s.splice(s.indexOf(e),1):s.push(e),t.setState({currentAttendance:s}),console.log(t.state.currentAttendance.length)},t.submitAttendance=function(){var e=Object(l.a)(o.a.mark((function e(n){var s,a,c;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(t.state.currentAttendance),s={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({students:t.state.currentAttendance,date:n})},e.next=4,fetch("/api/uploadAttendance",s);case 4:return a=e.sent,e.next=7,a.json();case 7:c=e.sent,c.success&&(window.location.href="/");case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t}return Object(u.a)(n,[{key:"renderDatePicker",value:function(){return Object(b.jsx)(f.a,{selected:new Date})}},{key:"render",value:function(){var t=this;return Object(b.jsxs)("div",{className:"attendance selection page container shadow-lg p-3 mb-5 bg-white rounded",children:[Object(b.jsx)("h1",{className:"m-3 mb-4",children:"Select Attending Students"}),Object(b.jsxs)("div",{style:{display:"flex",flexDirection:"row"},children:[Object(b.jsxs)("div",{className:"left panel mb-2 mr-5 ml-5",style:{width:"50%",paddingRight:"5%",alignItems:"center",borderRight:"2px dashed black"},children:[Object(b.jsx)("input",{onChange:this.studentSearchOnChange,type:"text",name:"studentSearch",id:"studentSearch",className:"form-control mt-1 mb-3",placeholder:"Search for a student",style:{width:"100%"}}),Object(b.jsx)("div",{className:"mapped students",style:{maxHeight:"30vh",overflow:"auto"},children:Object(b.jsx)("ul",{style:{listStyleType:"none",paddingLeft:"0px",textAlign:"center",marginRight:"5px"},children:this.state.students.map((function(e,n){return Object(b.jsx)(m,{name:e.name,grade:e.grade,addStudentToAttending:t.addStudentToAttending},n)}))})})]}),Object(b.jsx)("div",{className:"right panel mb-5 mt-5",style:{textAlign:"center",width:"37%"},children:Object(b.jsxs)("div",{className:"controls",style:{height:"80%"},children:[Object(b.jsxs)("h2",{className:"m-3",children:[this.state.currentAttendance.length," students selected"]}),Object(b.jsx)("p",{children:this.renderDatePicker()}),Object(b.jsxs)("div",{children:[Object(b.jsx)("button",{onClick:function(){return t.submitAttendance(new Date)},className:"btn btn-primary btn-lg m-3",children:"Submit Class"}),Object(b.jsx)("button",{className:"btn btn-primary btn-lg m-2",onClick:function(){return window.location.href="/"},children:"Home"})]})]})})]})]})}}]),n}(s.Component)),O=function(t){Object(h.a)(n,t);var e=Object(p.a)(n);function n(){var t;Object(d.a)(this,n);for(var s=arguments.length,a=new Array(s),c=0;c<s;c++)a[c]=arguments[c];return(t=e.call.apply(e,[this].concat(a))).state={},t}return Object(u.a)(n,[{key:"render",value:function(){return Object(b.jsxs)("form",{method:"POST",action:"/api/submit_student?school_id="+this.props.school_id,className:"shadow-lg p-3 mb-5 bg-white rounded page container",id:"newStudnetForm",style:{textAlign:"left"},children:[Object(b.jsx)("h1",{style:{textAlign:"center"},children:"Enter New Student Details"}),Object(b.jsxs)("div",{style:{paddingLeft:"5%",paddingRight:"5%",overflow:"auto"},children:[Object(b.jsxs)("p",{children:["First Name:",Object(b.jsx)("input",{name:"first_name",type:"text",style:{width:"100%"},class:"form-control"})]}),Object(b.jsxs)("p",{children:["Last Name:",Object(b.jsx)("input",{name:"last_name",type:"text",style:{width:"100%"},class:"form-control"})]}),Object(b.jsxs)("p",{children:["Date of Birth:",Object(b.jsx)("input",{name:"dob",type:"text",style:{width:"100%"},class:"form-control"})]}),Object(b.jsxs)("p",{children:["Phone Number:",Object(b.jsx)("input",{name:"phone",type:"text",style:{width:"100%"},class:"form-control"})]}),Object(b.jsxs)("p",{children:["Address:",Object(b.jsx)("input",{name:"address",type:"text",style:{width:"100%"},class:"form-control"})]}),Object(b.jsxs)("p",{children:["Email:",Object(b.jsx)("input",{name:"email",type:"text",style:{width:"100%"},class:"form-control"})]})]}),Object(b.jsxs)("div",{style:{textAlign:"center"},children:[Object(b.jsx)("button",{type:"submit",className:"btn btn-primary btn-lg m-2",style:{width:"20%"},children:"Submit"}),Object(b.jsx)("button",{type:"cancel",className:"btn btn-danger btn-lg m-2",style:{width:"20%"},onClick:function(t){t.preventDefault(),window.location.href="/"},children:"Cancel"})]})]})}}]),n}(s.Component),y=function(t){Object(h.a)(n,t);var e=Object(p.a)(n);function n(){var t;Object(d.a)(this,n);for(var s=arguments.length,a=new Array(s),c=0;c<s;c++)a[c]=arguments[c];return(t=e.call.apply(e,[this].concat(a))).state={},t.handleClick=function(){t.props.navigateToStudent(t.props.student)},t.checkStyle=function(){},t}return Object(u.a)(n,[{key:"render",value:function(){return Object(b.jsx)("li",{children:Object(b.jsx)("button",{onClick:this.handleClick,className:"btn m-2 btn-outline-dark",children:this.props.student.name})})}}]),n}(s.Component),v=function(t){Object(h.a)(n,t);var e=Object(p.a)(n);function n(){var t;Object(d.a)(this,n);for(var s=arguments.length,a=new Array(s),c=0;c<s;c++)a[c]=arguments[c];return(t=e.call.apply(e,[this].concat(a))).state={acceptClick:!0},t}return Object(u.a)(n,[{key:"clickHandler",value:function(){}},{key:"render",value:function(){var t=this,e=new Date(this.props.class.date);return e=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"][e.getDay()]+" - "+e.getDate()+"/"+(e.getMonth()+1)+"/"+e.getFullYear(),Object(b.jsxs)("div",{className:"class info",style:{height:"5vh",display:"flex",borderBottom:"1px dashed black",cursor:"pointer",alignItems:"center"},onClick:function(){t.state.acceptClick&&t.props.clickHandler(t.props.id)},children:[Object(b.jsx)("h5",{style:{maxWidth:"80%",width:"80%"},children:e}),Object(b.jsx)("h5",{children:this.props.class.attendees.length})]})}}]),n}(s.Component),w=function(t){Object(h.a)(n,t);var e=Object(p.a)(n);function n(){var t;Object(d.a)(this,n);for(var s=arguments.length,a=new Array(s),c=0;c<s;c++)a[c]=arguments[c];return(t=e.call.apply(e,[this].concat(a))).state={},t}return Object(u.a)(n,[{key:"render",value:function(){return Object(b.jsxs)("div",{className:"left panel",style:{minWidth:"15vw",maxHeight:"80%"},children:[Object(b.jsx)("h1",{style:{textAlign:"center",overflowX:"auto",overflowY:"hidden"},children:this.props.student.name}),Object(b.jsxs)("ul",{className:"",style:{textAlign:"center",listStyle:"none",margin:"0",padding:"0"},children:[Object(b.jsx)("li",{children:this.props.student.dob}),Object(b.jsx)("li",{children:this.props.student.phone}),Object(b.jsx)("li",{children:this.props.student.grade})]}),Object(b.jsx)("h3",{children:"Attended Classes"}),Object(b.jsx)("div",{className:"student attendance mt-3",style:{maxHeight:"50vh",overflow:"auto"},children:this.props.classes.map((function(t){return Object(b.jsx)(v,{class:t,acceptClick:!1})}))}),Object(b.jsxs)("div",{className:"control panel",style:{width:"100%",textAlign:"center"},children:[Object(b.jsx)("button",{className:"btn btn-primary btn-lg m-2",children:"Edit"}),Object(b.jsx)("button",{className:"btn btn-primary btn-lg m-2",onClick:function(){return window.location.href="/"},children:"Home"}),Object(b.jsx)("button",{className:"btn btn-primary btn-lg m-2",children:"Back"})]})]})}}]),n}(s.Component),k=n(46),S=function(t){Object(h.a)(n,t);var e=Object(p.a)(n);function n(){var t;Object(d.a)(this,n);for(var s=arguments.length,a=new Array(s),c=0;c<s;c++)a[c]=arguments[c];return(t=e.call.apply(e,[this].concat(a))).state={datasets:[{backgroundColor:"#007bff",borderColor:"rgba(0,0,0,1)",data:[t.props.student,t.props.average]}],labels:[t.props.name,"Average"]},t}return Object(u.a)(n,[{key:"componentDidMount",value:function(){console.log(this.props)}},{key:"render",value:function(){return Object(b.jsx)("div",{children:Object(b.jsx)(k.a,{data:this.state,style:{background:"white",maxHeight:"25vh",maxWidth:"80%",marginLeft:"10%"},options:{plugins:{title:{display:!0,text:"Student Attendance vs Average",fontSize:20},legend:{display:!1}}}})})}}]),n}(a.a.Component),N=function(t){Object(h.a)(n,t);var e=Object(p.a)(n);function n(){var t;Object(d.a)(this,n);for(var s=arguments.length,a=new Array(s),c=0;c<s;c++)a[c]=arguments[c];return(t=e.call.apply(e,[this].concat(a))).state={},t}return Object(u.a)(n,[{key:"formatDate",value:function(){var t=new Date(this.props.note.date),e=t.getDate(),n=t.getMonth()+1,s=t.getFullYear();return e<10&&(e="0"+e),n<10&&(n="0"+n),"".concat(e,"/").concat(n,"/").concat(s)}},{key:"render",value:function(){var t=this.formatDate();return console.log(t),Object(b.jsxs)("div",{className:"note component m-2",style:{minHeight:"10vh",background:"white",padding:"5px",paddingRight:"10px",borderBottom:"2px dashed black",textAlign:"justify",textJustify:"inter-word"},children:[Object(b.jsx)("div",{className:"note content",style:{overflowY:"auto"},children:Object(b.jsx)("h5",{children:this.props.note.content})}),Object(b.jsx)("div",{className:"note info",style:{display:"flex",flexDirection:"column"},children:this.props.note.author+"  -  "+t})]})}}]),n}(s.Component),A=function(t){Object(h.a)(n,t);var e=Object(p.a)(n);function n(){var t;Object(d.a)(this,n);for(var s=arguments.length,a=new Array(s),c=0;c<s;c++)a[c]=arguments[c];return(t=e.call.apply(e,[this].concat(a))).state={},t}return Object(u.a)(n,[{key:"render",value:function(){return Object(b.jsxs)("form",{method:"POST",action:"/api/postNote?school_id="+this.props.student.school+"&student_id="+this.props.student.name,style:{margin:"2.5%"},children:[Object(b.jsx)("textarea",{name:"content",id:"noteContent",style:{height:"90%",width:"100%",border:"none",overflow:"auto"},wrap:"hard",rows:"9",columns:"2",placeholder:"Enter a note here"}),Object(b.jsx)("p",{}),Object(b.jsx)("button",{className:"btn btn-success",type:"submit",children:"Post Note"}),Object(b.jsx)("button",{className:"btn btn-danger ml-3",type:"cancel",onClick:function(t){t.preventDefault()},children:"Cancel"})]})}}]),n}(s.Component),C=function(t){Object(h.a)(n,t);var e=Object(p.a)(n);function n(){var t;Object(d.a)(this,n);for(var s=arguments.length,a=new Array(s),c=0;c<s;c++)a[c]=arguments[c];return(t=e.call.apply(e,[this].concat(a))).state={},t.getNotes=Object(l.a)(o.a.mark((function e(){var n,s,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({student:t.props.student})},e.next=3,fetch("/api/getNotes",n);case 3:return s=e.sent,e.next=6,s.json();case 6:a=e.sent,t.setState({notes:a.result});case 8:case"end":return e.stop()}}),e)}))),t}return Object(u.a)(n,[{key:"toggleNoteSubmissionPanel",value:function(){r.a.render(Object(b.jsx)(A,{student:this.props.student}),document.querySelector(".student.notes")),console.log("attempting to render")}},{key:"componentDidMount",value:function(){this.getNotes()}},{key:"render",value:function(){var t=this;return this.state.notes?Object(b.jsxs)("div",{className:"right panel ml-4",style:{textAlign:"center"},children:[Object(b.jsx)("h1",{children:"Attendance"}),Object(b.jsx)("div",{className:"attendance graph",style:{maxHeight:"35%"},children:Object(b.jsx)(S,{name:this.props.student.name,student:this.props.studentAttendance,average:this.props.averageAttendancePerStudent})}),Object(b.jsx)("h1",{children:"Notes"}),Object(b.jsxs)("div",{className:"student notes mb-5",style:{border:"1px solid black",height:"30vh",width:"35vw"},children:[Object(b.jsx)("div",{className:"notes content m-2",style:{height:"75%",overflowY:"auto"},children:this.state.notes.map((function(t){return Object(b.jsx)(N,{note:t})}))}),Object(b.jsxs)("div",{className:"control panel",children:[Object(b.jsx)("button",{className:"btn btn-primary m-2",onClick:function(){return t.toggleNoteSubmissionPanel()},children:"Add Note"}),Object(b.jsx)("button",{className:"btn btn-primary m-2",children:"Edit Notes"})]})]})]}):null}}]),n}(s.Component),P=function(t){Object(h.a)(n,t);var e=Object(p.a)(n);function n(){var t;Object(d.a)(this,n);for(var s=arguments.length,a=new Array(s),c=0;c<s;c++)a[c]=arguments[c];return(t=e.call.apply(e,[this].concat(a))).state={},t.getStudentAttendance=Object(l.a)(o.a.mark((function e(){var n,s,a,c,r,i,l,d,u;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.props.student.school,s=t.props.student.name,a=0,c={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({school:n,name:s})},e.next=6,fetch("/api/getStudentAttendance",c);case 6:return r=e.sent,e.next=9,r.json();case 9:return i=e.sent,e.next=12,fetch("/api/getFullAttendance",c);case 12:return l=e.sent,e.next=15,l.json();case 15:(d=e.sent).result.forEach((function(t){a+=t.attendees.length})),u=a/t.props.totalStudents,t.setState({studentAttendance:i.result.length,averageAttendancePerStudent:u,attendedClasses:d.result});case 19:case"end":return e.stop()}}),e)}))),t}return Object(u.a)(n,[{key:"componentDidMount",value:function(){this.getStudentAttendance()}},{key:"render",value:function(){return this.state.studentAttendance?Object(b.jsxs)("div",{className:"page container shadow-lg p-3 mb-5 bg-white rounded",style:{display:"flex",flexDirection:"row",marginTop:"10%"},children:[Object(b.jsx)(w,{student:this.props.student,classes:this.state.attendedClasses}),Object(b.jsx)(C,{student:this.props.student,studentAttendance:this.state.studentAttendance,averageAttendancePerStudent:this.state.averageAttendancePerStudent})]}):null}}]),n}(s.Component),T=function(t){Object(h.a)(n,t);var e=Object(p.a)(n);function n(){var t;Object(d.a)(this,n);for(var s=arguments.length,a=new Array(s),c=0;c<s;c++)a[c]=arguments[c];return(t=e.call.apply(e,[this].concat(a))).state={},t.navigateToStudent=function(e){r.a.render(Object(b.jsx)(P,{student:e,totalStudents:t.props.students.length}),document.querySelector(".container"))},t}return Object(u.a)(n,[{key:"render",value:function(){var t=this;return Object(b.jsx)("div",{className:"page container shadow-lg p-3 mb-5 bg-white rounded",style:{display:"flex",flexDirection:"row",maxWidth:"60vh"},children:Object(b.jsxs)("div",{className:"left panel",style:{maxHeight:"80%",width:"100%"},children:[Object(b.jsx)("h1",{style:{textAlign:"center",overflowX:"auto",overflowY:"hidden"},children:"Select a Student"}),Object(b.jsx)("ul",{style:{listStyle:"none",textAlign:"center",paddingLeft:"0px",maxHeight:"60vh",overflowY:"auto",width:"100%"},children:this.props.students.map((function(e){return Object(b.jsx)(y,{student:e,navigateToStudent:t.navigateToStudent})}))}),Object(b.jsxs)("div",{className:"control panel",style:{width:"100%",textAlign:"center"},children:[Object(b.jsx)("button",{className:"btn btn-primary btn-lg m-2",children:"Edit"}),Object(b.jsx)("button",{className:"btn btn-primary btn-lg m-2",onClick:function(){return window.location.href="/"},children:"Home"}),Object(b.jsx)("button",{className:"btn btn-primary btn-lg m-2",children:"Back"})]})]})})}}]),n}(s.Component),D=(s.Component,function(t){Object(h.a)(n,t);var e=Object(p.a)(n);function n(){var t;Object(d.a)(this,n);for(var s=arguments.length,a=new Array(s),c=0;c<s;c++)a[c]=arguments[c];return(t=e.call.apply(e,[this].concat(a))).state={},t}return Object(u.a)(n,[{key:"clickHandler",value:function(){console.log(this.props.student.name),!1!==this.props.displayAttendance&&r.a.render(Object(b.jsx)(P,{student:this.props.student,totalStudents:this.props.totalStudents}),document.querySelector(".container"))}},{key:"checkDisplay",value:function(){if(!1!==this.props.displayAttendance)return Object(b.jsxs)("h5",{children:[Math.round(100*this.props.attendancePercentage)/100,"%"]})}},{key:"render",value:function(){var t,e=this;return t="string"===typeof this.props.student?this.props.student:this.props.student.name,Object(b.jsxs)("div",{className:"student info",style:{height:"5vh",display:"flex",borderBottom:"1px dashed black",cursor:"pointer",alignItems:"center"},onClick:function(){return e.clickHandler()},children:[Object(b.jsx)("h5",{style:{maxWidth:"80%",width:"80%"},children:t}),this.checkDisplay()]})}}]),n}(s.Component)),L=function(t){Object(h.a)(n,t);var e=Object(p.a)(n);function n(){var t;Object(d.a)(this,n);for(var s=arguments.length,a=new Array(s),c=0;c<s;c++)a[c]=arguments[c];return(t=e.call.apply(e,[this].concat(a))).state={students:t.props.students},t}return Object(u.a)(n,[{key:"render",value:function(){var t=this;if(void 0===this.props.fullAttendanceArray)return null;switch(this.props.display){case"Students":return Object(b.jsx)("div",{children:Object(b.jsx)("div",{className:"students overview ml-2",style:{height:"45vh",overflowY:"auto",paddingRight:"10px"},children:this.props.students.map((function(e,n){return Object(b.jsx)(D,{student:e,attendancePercentage:t.props.fullAttendanceArray[e.name],totalStudents:t.props.students.length},n)}))})});case"Single":return Object(b.jsx)("div",{children:Object(b.jsx)("div",{className:"students overview ml-2",style:{height:"45vh",overflowY:"auto",paddingRight:"10px"},children:this.props.classList[this.props.classKey].attendees.map((function(t,e){return Object(b.jsx)(D,{student:t,attendancePercentage:"",displayAttendance:!1},e)}))})});case"Classes":return Object(b.jsx)("div",{children:Object(b.jsx)("div",{className:"students overview ml-2",style:{height:"45vh",overflowY:"auto",paddingRight:"10px"},children:this.props.classList.map((function(e,n){return Object(b.jsx)(v,{class:e,id:n,clickHandler:function(){return t.props.classClickHandler(n)}},n)}))})})}}}]),n}(s.Component),H=function(t){Object(h.a)(n,t);var e=Object(p.a)(n);function n(){var t;Object(d.a)(this,n);for(var s=arguments.length,a=new Array(s),c=0;c<s;c++)a[c]=arguments[c];return(t=e.call.apply(e,[this].concat(a))).state={datasets:[{backgroundColor:"#007bff",borderColor:"rgba(0,0,0,1)",data:t.props.counts}],labels:[]},t}return Object(u.a)(n,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){if(0===this.state.labels.length){var t=[];this.props.dates.forEach((function(e){e=e.getDate()+"/"+(e.getMonth()+1)+"/"+e.getFullYear(),t.push(e)})),this.setState({labels:t})}return Object(b.jsx)("div",{children:Object(b.jsx)(k.a,{data:this.state,style:{background:"white",margin:"3%"},options:{plugins:{legend:{display:!1}}}})})}}]),n}(s.Component),M=function(t){Object(h.a)(n,t);var e=Object(p.a)(n);function n(){var t;Object(d.a)(this,n);for(var s=arguments.length,a=new Array(s),c=0;c<s;c++)a[c]=arguments[c];return(t=e.call.apply(e,[this].concat(a))).state={students:t.props.students,display:"Students",graphPeriod:1},t.componentDidMount=Object(l.a)(o.a.mark((function e(){var n,s,a,c,r,i;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({students:t.props.students,school:t.props.school.schoolID})},e.next=3,fetch("/api/getFullAttendance",n);case 3:return s=e.sent,e.next=6,s.json();case 6:return a=e.sent,console.log("here are all your classes: ",a.result),e.next=10,fetch("/api/calculateFullAttendancePercentages",n);case 10:return c=e.sent,e.next=13,c.json();case 13:r=e.sent,t.setState({classList:a.result,fullAttendanceArray:r.result,loaded:!0}),i=t.generateAttendanceGraphDataSet(),console.log(i);case 17:case"end":return e.stop()}}),e)}))),t.generateAttendanceGraphDataSet=function(){var e,n=t.state.classList,s=[],a=[];n.forEach((function(t){e=new Date(t.date),s.push(e),a.push(t.attendees.length)})),t.setState({dates:s,counts:a})},t.classClickHandler=function(e){console.log("clicked: "+e+typeof e),t.setState({classKey:e,display:"Single"})},t}return Object(u.a)(n,[{key:"setGraphPeriod",value:function(t){this.setState({graphPeriod:t})}},{key:"render",value:function(){var t=this;if(void 0===this.state.dates)return null;var e=new Date;e.setMonth(e.getMonth()-this.state.graphPeriod);var n=[],s=this.state.dates.filter((function(s,a){var c=new Date(s);return c>e?n.push(t.state.counts[a]):console.log(c),c>e}));return Object(b.jsxs)("div",{className:"start page container shadow-lg p-3 mb-5 bg-white rounded",style:{display:"flex",flexDirection:"row",marginTop:"10%",height:"65vh"},children:[Object(b.jsxs)("div",{className:"left panel",style:{minHeight:"45vh",width:"25%"},children:[Object(b.jsx)("h2",{style:{textAlign:"center",cursor:"pointer"},onClick:function(){return window.location.href="/"},children:this.props.school.name}),Object(b.jsxs)("div",{className:"filters panel ml-3",style:{textAlign:"center"},children:[Object(b.jsx)("button",{className:"btn btn-sm btn-outline-primary  m-2",onClick:function(){return t.setState({display:"Students"})},children:"Students"}),Object(b.jsx)("button",{className:"btn btn-sm btn-outline-primary m-2",onClick:function(){return t.setState({display:"Classes"})},children:"Classes"})]}),Object(b.jsx)(L,{students:this.state.students,school:this.props.school,display:this.state.display,classList:this.state.classList,fullAttendanceArray:this.state.fullAttendanceArray,graphData:this.state.graphData,classKey:this.state.classKey,classClickHandler:function(e){return t.classClickHandler(e)}})]}),Object(b.jsxs)("div",{className:"right panel",style:{width:"75%",height:"75vh",textAlign:"center"},children:[Object(b.jsxs)("h2",{children:["Attendance over past ",this.state.graphPeriod," months"]}),Object(b.jsx)(H,{dates:s.reverse(),counts:n.reverse()}),Object(b.jsxs)("div",{className:"controls panel",children:[Object(b.jsx)("button",{className:"btn btn-outline-success btn-lg m-2",onClick:function(){return t.setGraphPeriod(1)},children:"1 Month"}),Object(b.jsx)("button",{className:"btn btn-outline-success btn-lg m-2",onClick:function(){return t.setGraphPeriod(3)},children:"3 Months"}),Object(b.jsx)("button",{className:"btn btn-outline-success btn-lg m-2",onClick:function(){return t.setGraphPeriod(6)},children:"6 Months"}),Object(b.jsx)("button",{className:"btn btn-outline-success btn-lg m-2",onClick:function(){return t.setGraphPeriod(12)},children:"12 Months"}),Object(b.jsx)("button",{className:"btn btn-primary btn-lg m-2",onClick:function(){return window.location.href="/"},children:"Home"})]})]})]})}}]),n}(s.Component),F=function(t){Object(h.a)(n,t);var e=Object(p.a)(n);function n(){var t;Object(d.a)(this,n);for(var s=arguments.length,a=new Array(s),c=0;c<s;c++)a[c]=arguments[c];return(t=e.call.apply(e,[this].concat(a))).state={isHidden:!1},t.navigateToNewClass=function(){console.log("Navigated to New Class"),r.a.render(Object(b.jsx)(x,{students:t.props.students}),document.querySelector(".container"))},t.navigateToTrends=function(){console.log("Navigated to Trends"),r.a.render(Object(b.jsx)(M,{students:t.props.students,school:t.props.school}),document.querySelector(".container"))},t.navigateToNewStudent=function(){console.log("Navigated to Admin"),r.a.render(Object(b.jsx)(O,{school_id:t.props.school.schoolID}),document.querySelector(".container"))},t.logOut=function(){document.cookie="school_id=;expires=Thu, 01 Jan 1970 00:00:00 GMT",setTimeout((function(){window.location.href="/"}),1e3)},t}return Object(u.a)(n,[{key:"render",value:function(){return Object(b.jsxs)("div",{className:"start page container shadow-lg p-3 mb-5 bg-white rounded",children:[Object(b.jsxs)("h1",{className:"m-3",style:{textAlign:"center"},children:["Welcome to ",this.props.school.name,Object(b.jsx)("br",{}),"What would you like to do?"]}),Object(b.jsx)("button",{className:"btn btn-primary btn-lg m-3",onClick:this.navigateToNewClass,style:{width:"50%",alignSelf:"center"},children:"Start a Class"}),Object(b.jsx)("button",{className:"btn btn-primary btn-lg m-3",onClick:this.navigateToTrends,style:{width:"50%",alignSelf:"center"},children:"View Trends"}),Object(b.jsx)("button",{className:"btn btn-primary btn-lg m-3",onClick:this.navigateToNewStudent,style:{width:"50%",alignSelf:"center"},children:"Add New Student"}),Object(b.jsx)("button",{className:"btn btn-danger btn-lg m-3",onClick:this.logOut,style:{width:"25%",alignSelf:"center"},children:"Log Out"})]})}}]),n}(s.Component),R=function(t){Object(h.a)(n,t);var e=Object(p.a)(n);function n(){var t;Object(d.a)(this,n);for(var s=arguments.length,a=new Array(s),c=0;c<s;c++)a[c]=arguments[c];return(t=e.call.apply(e,[this].concat(a))).state={},t}return Object(u.a)(n,[{key:"render",value:function(){return Object(b.jsxs)("form",{method:"POST",action:"/api/addNewSchool",className:"shadow-lg p-3 mb-5 bg-white rounded page container",id:"newSchoolForm",style:{marginTop:"10%"},children:[Object(b.jsxs)("div",{style:{paddingLeft:"5%",paddingRight:"5%",textAlign:"left"},children:[Object(b.jsx)("h1",{style:{textAlign:"center"},children:"Welcome"}),Object(b.jsxs)("p",{children:["Name of School:",Object(b.jsx)("input",{name:"school_name",type:"text",style:{width:"100%"},class:"form-control",required:"true"})]}),Object(b.jsxs)("p",{children:["Email:",Object(b.jsx)("input",{name:"email",type:"email",style:{width:"100%"},class:"form-control",required:"true"})]}),Object(b.jsxs)("p",{children:["First Name:",Object(b.jsx)("input",{name:"first_name",type:"text",style:{width:"100%"},class:"form-control",required:"true"})]}),Object(b.jsxs)("p",{children:["Last Name:",Object(b.jsx)("input",{name:"last_name",type:"text",style:{width:"100%"},class:"form-control",required:"true"})]}),Object(b.jsxs)("p",{children:["Phone (Optional):",Object(b.jsx)("input",{name:"phone",type:"tel",style:{width:"100%"},class:"form-control"})]}),Object(b.jsxs)("p",{children:["Postcode (Optional):",Object(b.jsx)("input",{name:"postcode",type:"number",style:{width:"100%"},class:"form-control"})]}),Object(b.jsxs)("p",{children:["Password:",Object(b.jsx)("input",{name:"password",type:"password",style:{width:"100%"},class:"form-control",required:"true",minLength:"8",maxLength:"30"})]})]}),Object(b.jsxs)("div",{style:{textAlign:"center"},children:[Object(b.jsx)("button",{type:"submit",className:"btn btn-primary btn-lg m-2",style:{width:"20%"},children:"Submit"}),Object(b.jsx)("button",{className:"btn btn-danger btn-lg m-2",style:{width:"20%"},onClick:function(){return window.location.href="/"},children:"Cancel"})]})]})}}]),n}(s.Component),E=function(t){Object(h.a)(n,t);var e=Object(p.a)(n);function n(){var t;Object(d.a)(this,n);for(var s=arguments.length,a=new Array(s),c=0;c<s;c++)a[c]=arguments[c];return(t=e.call.apply(e,[this].concat(a))).state={display:"Login"},t}return Object(u.a)(n,[{key:"createAccount",value:function(t){t.preventDefault(),r.a.render(Object(b.jsx)(R,{}),document.querySelector(".container"))}},{key:"render",value:function(){var t=this;switch(this.props.display&&this.props.display!==this.state.display&&this.setState({display:this.props.display}),this.state.display){case"Login":return Object(b.jsx)("form",{method:"POST",action:"/api/login",className:"shadow-lg p-3 mb-5 bg-white rounded page container",id:"newStudnetForm",style:{marginTop:"20%",width:"30%",paddingLeft:"5%",paddingRight:"5%"},children:Object(b.jsxs)("div",{style:{textAlign:"left",margin:"5%"},children:[Object(b.jsx)("h1",{style:{textAlign:"center"},children:"Login"}),Object(b.jsxs)("p",{children:["Email:",Object(b.jsx)("input",{name:"email",type:"text",style:{width:"100%"},class:"form-control"})]}),Object(b.jsxs)("p",{children:["Password:",Object(b.jsx)("input",{name:"password",type:"password",style:{width:"100%"},class:"form-control"}),Object(b.jsx)("a",{class:"hyperlink",onClick:function(){return t.setState({display:"Reset"})},children:"Forgot your password?"})]}),Object(b.jsxs)("div",{style:{textAlign:"center",display:"flex",flexDirection:"column"},children:[Object(b.jsx)("button",{type:"submit",className:"btn btn-success mt-3",onClick:this.login,children:"Submit"}),Object(b.jsx)("button",{type:"cancel",className:"btn btn-secondary mt-3",onClick:this.createAccount,children:"Create Account"})]})]})});case"Reset":return Object(b.jsxs)("form",{method:"POST",action:"/api/sendTestEmail",className:"shadow-lg p-3 mb-5 bg-white rounded page container",id:"newStudnetForm",style:{marginTop:"20%",width:"30%",paddingLeft:"5%",paddingRight:"5%"},children:[Object(b.jsxs)("div",{children:[Object(b.jsx)("h1",{style:{textAlign:"center"},children:"Reset Password"}),Object(b.jsx)("p",{children:"Enter your email below to receive a password reset email"}),Object(b.jsxs)("p",{children:["Email:",Object(b.jsx)("input",{name:"email",type:"text",style:{width:"100%"},class:"form-control"}),Object(b.jsx)("a",{class:"hyperlink",onClick:function(){return t.setState({display:"Login"})},children:"Back to sign in"})]})]}),Object(b.jsx)("div",{style:{textAlign:"center",display:"flex",flexDirection:"column"},children:Object(b.jsx)("button",{type:"submit",className:"btn btn-success mt-3",onClick:this.login,children:"Submit"})})]});case"Password":var e=new URLSearchParams(window.location.search).get("token");return Object(b.jsxs)("form",{method:"POST",action:"/api/updateUserPassword?token=".concat(e),className:"shadow-lg p-3 mb-5 bg-white rounded page container",id:"newStudnetForm",style:{marginTop:"20%",width:"30%",paddingLeft:"5%",paddingRight:"5%"},children:[Object(b.jsxs)("div",{children:[Object(b.jsx)("h1",{style:{textAlign:"center"},children:"Reset Password"}),Object(b.jsx)("p",{children:"Enter your new password below"}),Object(b.jsxs)("p",{children:["Password:",Object(b.jsx)("input",{name:"password",type:"password",style:{width:"100%"},class:"form-control",minLength:"8"})]})]}),Object(b.jsx)("div",{style:{textAlign:"center",display:"flex",flexDirection:"column"},children:Object(b.jsx)("button",{type:"submit",className:"btn btn-success mt-3",onClick:this.login,children:"Submit"})})]})}}}]),n}(s.Component),_=function(t){Object(h.a)(n,t);var e=Object(p.a)(n);function n(){var t;Object(d.a)(this,n);for(var s=arguments.length,a=new Array(s),c=0;c<s;c++)a[c]=arguments[c];return(t=e.call.apply(e,[this].concat(a))).state={school:{},students:[]},t.componentDidMount=Object(l.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.getSchool(),t.fetchStudents(),t.resetPassword();case 3:case"end":return e.stop()}}),e)}))),t.resetPassword=Object(l.a)(o.a.mark((function e(){var n,s,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=new URLSearchParams(window.location.search),s=n.get("token"),console.log(s),a={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:s})},!s){e.next=8;break}return e.next=7,fetch("/api/resetPassword",a);case 7:t.setState({display:"Password"});case 8:case"end":return e.stop()}}),e)}))),t.getSchool=Object(l.a)(o.a.mark((function e(){var n,s,a,c;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("getting school"),0!=document.cookie.length){e.next=6;break}return console.log("cookie length = 0"),e.abrupt("return");case 6:return n=document.cookie.split("school_id=")[1].split("=")[0],s={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({school_id:n})},e.next=10,fetch("/api/getSchool",s);case 10:return a=e.sent,e.next=13,a.json();case 13:return c=(c=e.sent).result[0],e.abrupt("return",t.setState({school:c}));case 16:case"end":return e.stop()}}),e)}))),t.generateContent=Object(l.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.state.display;case 1:case"end":return e.stop()}}),e)}))),t}return Object(u.a)(n,[{key:"fetchStudents",value:function(){var t=this;fetch("/api/getStudents").then(function(){var e=Object(l.a)(o.a.mark((function e(n){var s;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.json();case 2:return s=e.sent,e.abrupt("return",t.setState({students:s.result}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(t){return console.log(t)}))}},{key:"render",value:function(){return 0===document.cookie.length?"Password"===this.state.display?Object(b.jsxs)(a.a.Fragment,{children:[Object(b.jsx)(j,{}),Object(b.jsx)("main",{className:"container",children:Object(b.jsx)(E,{display:"Password"})})]}):(console.log("no cookie exists"),Object(b.jsxs)(a.a.Fragment,{children:[Object(b.jsx)(j,{}),Object(b.jsx)("main",{className:"login container",children:Object(b.jsx)(E,{})})]})):Object(b.jsxs)(a.a.Fragment,{children:[Object(b.jsx)(j,{}),Object(b.jsx)("main",{className:"container",children:Object(b.jsx)(F,{school:this.state.school,students:this.state.students})})]})}}]),n}(s.Component);n(257);r.a.render(Object(b.jsx)(_,{}),document.getElementById("root"))},32:function(t,e,n){}},[[259,1,2]]]);
//# sourceMappingURL=main.1c3995d4.chunk.js.map